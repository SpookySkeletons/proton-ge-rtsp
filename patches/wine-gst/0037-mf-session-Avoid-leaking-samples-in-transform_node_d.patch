From f20285fe6f3663c0083bf14d0008f47896b616d2 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?R=C3=A9mi=20Bernon?= <rbernon@codeweavers.com>
Date: Wed, 13 Mar 2024 10:27:26 +0100
Subject: [PATCH 37/39] mf/session: Avoid leaking samples in
 transform_node_deliver_samples.

---
 dlls/mf/session.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/dlls/mf/session.c b/dlls/mf/session.c
index e1d7f7be204..94e0aece2a4 100644
--- a/dlls/mf/session.c
+++ b/dlls/mf/session.c
@@ -3401,7 +3401,10 @@ static void transform_node_deliver_samples(struct media_session *session, struct
         stream = &topo_node->u.transform.inputs[input];
 
         if (SUCCEEDED(transform_stream_pop_sample(stream, &sample)))
+        {
             session_deliver_sample_to_node(session, topo_node->node, input, sample);
+            IMFSample_Release(sample);
+        }
         else if (FAILED(hr = IMFTopologyNode_GetInput(topo_node->node, input, &up_node, &output)))
             WARN("Failed to get node %p/%lu input, hr %#lx\n", topo_node->node, input, hr);
         else
-- 
2.44.0

